<% layout("layouts/boilerplate") %>

<style>
    #filter {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 2rem;
        margin-bottom: 2rem;
    }

    .filter {
        text-align: center;
        opacity: 0.6;
        transition: opacity 0.3s;
    }

    .filter:hover {
        opacity: 1;
        cursor: pointer;
    }

    .filter p {
        font-style: italic;
        font-size: 1rem;
        margin: 0;
    }

    /* Dark Mode Styles */
    .dark-mode {
        background-color: #1a1a1a;
        color: #ffffff;
    }

    .dark-mode .card {
        background-color: #2d2d2d;
        border-color: #404040;
    }

    .dark-mode .text-dark {
        color: #ffffff !important;
    }

    .dark-mode-toggle {
        margin-left: auto;
        padding: 0.5rem;
    }

    #dark-mode-toggle {
        padding: 8px 16px;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s;
    }

    #dark-mode-toggle:hover {
        background-color: #45a049;
        transform: scale(1.05);
    }
</style>

<div class="container mt-4">
    <div id="filter">
        <a href="/listings/category/trending" class="filter">
            <div><i class="fa-solid fa-people-group"></i></div>
            <p>Trending</p>
        </a>
        <a href="/listings/category/rooms" class="filter">
            <div><i class="fa-solid fa-book-open"></i></div>
            <p>Rooms</p>
        </a>
        <a href="/listings/category/boats" class="filter">
            <div><i class="fa-regular fa-newspaper"></i></div>
            <p>Boats</p>
        </a>
        <a href="/listings/category/dooms" class="filter">
            <div><i class="fa-solid fa-building-circle-arrow-right"></i></div>
            <p>Dooms</p>
        </a>
        <a href="/listings/category/iconic%20cities" class="filter">
            <div><i class="fa-regular fa-note-sticky"></i></div>
            <p>Iconic Cities</p>
        </a>
        <a href="/listings/category/mountains" class="filter">
            <div><i class="fa-solid fa-rectangle-list"></i></div>
            <p>Mountains</p>
        </a>

        <div class="dark-mode-toggle">
            <button id="dark-mode-toggle">Switch to Dark Mode</button>
        </div>
    </div>

    <div class="row">
        <% if (allListings && allListings.length > 0) { %>
            <% for (let listing of allListings) { %>
                <div class="col-md-4 col-sm-6 mb-4">
                    <a href="/listings/<%= listing._id %>" class="text-decoration-none text-dark">
                        <div class="card h-100">
                            <img 
                                src="<%= listing.image.url %>" 
                                class="card-img-top" 
                                alt="<%= listing.title %>" 
                                style="height: 20rem; object-fit: cover;"
                            />
                            <div class="card-body">
                                <h5 class="card-title"><%= listing.title %></h5>
                                <p class="card-text">
                                    &#8377; <%= listing.price.toLocaleString("en-IN") %>
                                </p>
                            </div>
                        </div>
                    </a>
                </div>
            <% } %>
        <% } else { %>
            <div class="col-12 text-center">
                <p class="text-muted">No listings available at the moment.</p>
            </div>
        <% } %>
    </div>
</div>

<script>
    // Dark Mode Toggle
    const darkModeToggle = document.getElementById('dark-mode-toggle');
    const body = document.body;

    // Initialize dark mode from localStorage
    const savedDarkMode = localStorage.getItem('darkMode') === 'true';
    if (savedDarkMode) {
        body.classList.add('dark-mode');
        darkModeToggle.textContent = 'Switch to Light Mode';
    }

    darkModeToggle.addEventListener('click', () => {
        body.classList.toggle('dark-mode');
        const isDarkMode = body.classList.contains('dark-mode');
        
        // Update button text and save preference
        darkModeToggle.textContent = isDarkMode 
            ? 'Switch to Light Mode' 
            : 'Switch to Dark Mode';
        localStorage.setItem('darkMode', isDarkMode);
    });
</script>